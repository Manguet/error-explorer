<section class="pricing" id="pricing">
    <div class="container">
        <div class="section-title">
            <h2>Tarifs transparents</h2>
            <p>Choisissez le plan qui correspond √† vos besoins</p>
        </div>

        <div class="pricing-grid">
            {% for plan in plans %}
                <div class="pricing-card {{ plan.isPopular ? 'popular' : '' }}">
                    <div class="plan-header">
                        <div class="plan-info">
                            <h3 class="plan-name">{{ plan.name }}</h3>
                            {% if plan.isPopular %}
                                <div class="popular-badge">
                                    <span class="badge-icon">‚≠ê</span>
                                    <span>Plus populaire</span>
                                </div>
                            {% endif %}
                        </div>
                        <div class="plan-price-container">
                            <div class="plan-price">
                                {% if plan.isFree %}
                                    Gratuit
                                {% else %}
                                    {{ plan.priceMonthly|number_format(2, ',', ' ') }}‚Ç¨
                                {% endif %}
                            </div>
                            {% if not plan.isFree %}
                                <div class="plan-price-unit">par mois</div>
                            {% endif %}
                        </div>
                    </div>

                    {% if plan.description %}
                        <div class="plan-description">
                            {{ plan.description }}
                        </div>
                    {% endif %}

                    <div class="plan-metrics">
                        <div class="metric {{ plan.isPopular ? 'metric-highlighted' : '' }}">
                            <div class="metric-value">
                                {{ plan.maxProjectsLabel }}
                            </div>
                            <div class="metric-label">Projets</div>
                        </div>

                        <div class="metric {{ plan.isPopular ? 'metric-highlighted' : '' }}">
                            <div class="metric-value">
                                {{ plan.maxMonthlyErrorsLabel }}
                            </div>
                            <div class="metric-label">Erreurs/mois</div>
                        </div>

                        <div class="metric {{ plan.isPopular ? 'metric-highlighted' : '' }}">
                            <div class="metric-value">
                                {{ plan.dataRetentionDays }}
                            </div>
                            <div class="metric-label">Jours r√©tention</div>
                        </div>

                        <div class="metric {{ plan.isPopular ? 'metric-highlighted' : '' }}">
                            <div class="metric-value">
                                {% if plan.hasPrioritySupport %}
                                    1h
                                {% elseif plan.hasEmailAlerts %}
                                    4h
                                {% else %}
                                    24h
                                {% endif %}
                            </div>
                            <div class="metric-label">Support</div>
                        </div>
                    </div>

                    <div class="plan-features">
                        <div class="features-title">Fonctionnalit√©s incluses :</div>
                        <ul class="features-list">
                            <li class="feature-item">
                                <span class="feature-check">‚úì</span>
                                <span>Dashboard temps r√©el</span>
                            </li>

                            {% if plan.hasEmailAlerts %}
                                <li class="feature-item">
                                    <span class="feature-check">‚úì</span>
                                    <span>Alertes email</span>
                                </li>
                            {% endif %}

                            {% if plan.hasSlackIntegration %}
                                <li class="feature-item">
                                    <span class="feature-check">‚úì</span>
                                    <span>Int√©gration Slack</span>
                                </li>
                            {% endif %}

                            {% if plan.hasApiAccess %}
                                <li class="feature-item">
                                    <span class="feature-check">‚úì</span>
                                    <span>Acc√®s API complet</span>
                                </li>
                            {% endif %}

                            {% if plan.hasAdvancedFilters %}
                                <li class="feature-item">
                                    <span class="feature-check">‚úì</span>
                                    <span>Filtres avanc√©s</span>
                                </li>
                            {% endif %}

                            {% if plan.hasCustomRetention %}
                                <li class="feature-item">
                                    <span class="feature-check">‚úì</span>
                                    <span>R√©tention personnalis√©e</span>
                                </li>
                            {% endif %}

                            {% if plan.hasPrioritySupport %}
                                <li class="feature-item">
                                    <span class="feature-check">‚úì</span>
                                    <span>Support prioritaire</span>
                                </li>
                            {% endif %}
                        </ul>
                    </div>
                    {% if not plan.isFree and plan.maxMonthlyErrors != -1 %}
                        <div class="usage-indicator">
                            <div class="usage-bar">
                                <div class="usage-fill" style="width: 0%;"></div>
                            </div>
                            <div class="usage-text">
                                <span>Capacit√© mensuelle</span>
                                <span>{{ plan.maxMonthlyErrorsLabel }}</span>
                            </div>
                        </div>
                    {% endif %}

                    {% if plan.yearlySavings and plan.yearlySavings > 0 %}
                        <div class="yearly-savings">
                            <div class="savings-badge">
                                <span class="savings-icon">üí∞</span>
                                <span>√âconomisez {{ plan.yearlySavings|number_format(0, ',', ' ') }}‚Ç¨ par an</span>
                            </div>
                        </div>
                    {% endif %}

                    <div class="plan-action">
                        <a href="{{ path('app_register') }}?plan={{ plan.slug }}"
                           class="btn {{ plan.isPopular ? 'btn-primary' : 'btn-secondary' }} plan-cta-btn"
                           data-plan="{{ plan.slug }}">
                            {% if plan.isFree %}
                                <span>Commencer gratuitement</span>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M5 12h14M12 5l7 7-7 7"/>
                                </svg>
                            {% else %}
                                <span>Choisir {{ plan.name }}</span>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M5 12h14M12 5l7 7-7 7"/>
                                </svg>
                            {% endif %}
                        </a>

                        {% if not plan.isFree %}
                            <div class="plan-note">
                                Sans engagement ‚Ä¢ Annulation √† tout moment
                            </div>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</section>
