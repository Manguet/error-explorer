{% extends 'emails/base_email.html.twig' %}

{% block title %}Nouvelle erreur assign√©e - {{ app_name }}{% endblock %}

{% block header_class %}email-header--info{% endblock %}

{% block status_badge %}
    <div class="status-badge">üìã Assignation</div>
{% endblock %}

{% block email_title %}Nouvelle erreur assign√©e{% endblock %}

{% block email_subtitle %}Une erreur n√©cessite votre attention{% endblock %}

{% block body %}
    <h2>Bonjour {{ user.fullName }},</h2>
    
    <p>
        Une nouvelle erreur vous a √©t√© assign√©e dans le projet 
        <strong>{{ project.name }}</strong> et n√©cessite votre attention.
    </p>

    {% if assigned_by %}
        <div class="info-card">
            <div class="card-title">üë§ Assign√© par</div>
            <div class="card-content">
                <strong>{{ assigned_by.fullName }}</strong><br>
                Le {{ assigned_at|date('d/m/Y √† H:i') }}
            </div>
        </div>
    {% endif %}

    <div class="details-grid">
        <div class="detail-item">
            <div class="detail-label">Projet</div>
            <div class="detail-value">{{ project.name }}</div>
        </div>
        {% if project.environment %}
        <div class="detail-item">
            <div class="detail-label">Environnement</div>
            <div class="detail-value">{{ project.environment|title }}</div>
        </div>
        {% endif %}
    </div>

    <div class="error-card">
        <div class="card-title">üö® {{ error.exceptionClass }}</div>
        <div class="card-content">
            <div class="code-block">{{ error.message }}</div>
        </div>
    </div>

    <div class="details-grid-4">
        <div class="detail-item">
            <div class="detail-label">Fichier</div>
            <div class="detail-value">{{ error.file|split('/')|last }}:{{ error.line }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Occurrences</div>
            <div class="detail-value">{{ error.occurrenceCount }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Premi√®re fois</div>
            <div class="detail-value">{{ error.firstSeen|date('d/m/Y') }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Derni√®re fois</div>
            <div class="detail-value">{{ error.lastSeen|date('d/m/Y') }}</div>
        </div>
    </div>

    <div class="btn-center">
        <a href="{{ error_url }}" class="btn btn-primary btn-large">
            üîç Voir l'erreur en d√©tail
        </a>
        <a href="{{ project_url }}" class="btn btn-secondary">
            üìä Aller au projet
        </a>
    </div>

    <h3>üéØ Prochaines √©tapes</h3>
    <ol class="styled-ordered-list">
        <li>Consultez les d√©tails de l'erreur pour comprendre le contexte</li>
        <li>Analysez la stack trace et les conditions d'occurrence</li>
        <li>Reproduisez le probl√®me si possible</li>
        <li>Impl√©mentez et testez la correction</li>
        <li>Marquez l'erreur comme r√©solue une fois corrig√©e</li>
    </ol>

    <div class="warning-card">
        <div class="card-title">‚ö†Ô∏è Rappel important</div>
        <div class="card-content">
            Cette erreur vous a √©t√© sp√©cifiquement assign√©e. N'h√©sitez pas √† la r√©assigner 
            √† un autre membre de l'√©quipe si elle sort de votre domaine d'expertise.
        </div>
    </div>

    <p style="font-size: 14px; color: #64748b; margin-top: 30px;">
        üí° <strong>Astuce :</strong> Vous pouvez g√©rer vos pr√©f√©rences de notification 
        dans les <a href="{{ dashboard_url }}/settings" style="color: #3b82f6;">param√®tres de votre compte</a>.
    </p>
{% endblock %}

{% block additional_footer_links %}
    <a href="{{ unsubscribe_url }}" class="footer-link">Se d√©sabonner</a>
{% endblock %}