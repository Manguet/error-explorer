{% extends 'emails/base_email.html.twig' %}

{% block title %}Abonnement annul√© - Error Explorer{% endblock %}

{% block header_class %}email-header--warning{% endblock %}

{% block status_badge %}
    <div class="status-badge">
        üìã ABONNEMENT ANNUL√â
    </div>
{% endblock %}

{% block email_title %}Abonnement annul√©{% endblock %}

{% block email_subtitle %}Confirmation d'annulation de votre abonnement{% endblock %}

{% block body %}
    <h2>Bonjour {{ user.firstName }},</h2>

    <p>Nous confirmons l'annulation de votre abonnement Error Explorer. Nous esp√©rons vous revoir bient√¥t !</p>

    <!-- D√©tails de l'annulation -->
    <h3>üìã D√©tails de l'annulation</h3>
    <div class="details-grid">
        <div class="detail-item">
            <div class="detail-label">Plan annul√©</div>
            <div class="detail-value">{{ subscription.plan.name }}</div>
        </div>
        <div class="detail-item">
            <div class="detail-label">Date d'annulation</div>
            <div class="detail-value">{{ subscription.canceledAt | date('d/m/Y H:i') }}</div>
        </div>
        {% if subscription.cancelAt and subscription.cancelAt > subscription.canceledAt %}
            <div class="detail-item">
                <div class="detail-label">Fin de service</div>
                <div class="detail-value">{{ subscription.cancelAt | date('d/m/Y') }}</div>
            </div>
        {% else %}
            <div class="detail-item">
                <div class="detail-label">Fin de service</div>
                <div class="detail-value">Imm√©diate</div>
            </div>
        {% endif %}
        <div class="detail-item">
            <div class="detail-label">Dernier montant</div>
            <div class="detail-value">{{ subscription.formattedAmount }}</div>
        </div>
    </div>

    <!-- Statut du service -->
    {% if subscription.cancelAt and subscription.cancelAt > subscription.canceledAt %}
        <div class="info-card">
            <div class="card-title">
                üìÖ Acc√®s maintenu jusqu'au {{ subscription.cancelAt | date('d/m/Y') }}
            </div>
            <div class="card-content">
                Votre abonnement reste actif jusqu'√† la fin de votre p√©riode de facturation.
                Vous continuez √† b√©n√©ficier de toutes les fonctionnalit√©s de votre plan.
            </div>
        </div>
    {% else %}
        <div class="warning-card">
            <div class="card-title">
                ‚ö†Ô∏è Acc√®s imm√©diatement suspendu
            </div>
            <div class="card-content">
                Votre abonnement a √©t√© annul√© imm√©diatement.
                Votre compte est maintenant limit√© aux fonctionnalit√©s du plan gratuit.
            </div>
        </div>
    {% endif %}

    <!-- Ce qui change -->
    <h3>üîÑ Ce qui change maintenant</h3>
    <div class="info-card">
        <div class="card-content">
            <ul class="styled-list">
                <li>Retour aux limites du plan gratuit</li>
                <li>Conservation des donn√©es existantes selon la r√©tention gratuite</li>
                <li>Acc√®s limit√© aux fonctionnalit√©s avanc√©es</li>
                <li>Support technique standard uniquement</li>
            </ul>
        </div>
    </div>

    <!-- Donn√©es pr√©serv√©es -->
    <div class="success-card">
        <div class="card-title">
            üîí Vos donn√©es sont pr√©serv√©es
        </div>
        <div class="card-content">
            M√™me avec l'annulation, nous conservons vos projets et donn√©es selon notre politique de r√©tention.
            Si vous r√©activez votre abonnement, vous retrouverez tout comme avant.
        </div>
    </div>

    <!-- Feedback -->
    <div class="info-card text-center" style="border: 2px dashed #e2e8f0;">
        <div class="card-title">
            üí¨ Aidez-nous √† nous am√©liorer
        </div>
        <div class="card-content">
            <p>Votre avis nous int√©resse ! Dites-nous pourquoi vous avez annul√© votre abonnement.</p>
            <div style="margin-top: 15px;">
                <a href="{{ app_url }}{{ path('home_contact') }}?subject=Feedback annulation" class="btn btn-success">
                    üí¨ Donner mon avis
                </a>
            </div>
        </div>
    </div>

    <!-- Vous changez d'avis -->
    <div class="btn-center">
        <h3>Vous changez d'avis ?</h3>
        <p>Vous pouvez r√©activer votre abonnement √† tout moment et retrouver imm√©diatement toutes vos donn√©es et configurations.</p>
        <a href="{{ app_url }}{{ path('home_pricing') }}" class="btn btn-primary">
            üöÄ R√©activer mon abonnement
        </a>
    </div>

    <!-- Support disponible -->
    <div class="info-card">
        <div class="card-title">
            üí¨ Nous restons disponibles
        </div>
        <div class="card-content">
            Une question ? Notre √©quipe reste disponible pour vous aider, m√™me apr√®s l'annulation.
            N'h√©sitez pas √† nous contacter si vous avez besoin d'assistance.
        </div>
    </div>

    <p class="text-center">
        Merci d'avoir fait confiance √† Error Explorer.<br>
        Nous esp√©rons vous revoir bient√¥t !<br>
        <strong>L'√©quipe Error Explorer</strong>
    </p>
{% endblock %}

{% block additional_footer_links %}
    <a href="{{ app_url }}{{ path('dashboard_index') }}" class="footer-link">Mon dashboard</a>
    <a href="{{ app_url }}{{ path('home_pricing') }}" class="footer-link">Voir les plans</a>
{% endblock %}

{% block footer_legal %}
    Confirmation d'annulation d'abonnement Error Explorer<br>
    {{ "now"|date('d/m/Y √† H:i') }} | Nous esp√©rons vous revoir bient√¥t !
{% endblock %}
